<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=400">
  <title>AttentionGuard</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="logo">
        <img src="../assets/icons/brain-cog-red-32.png" alt="AttentionGuard">
        <span class="title">AttentionGuard</span>
      </div>
      <div class="header-actions">
        <button class="theme-toggle" id="themeToggle" title="Toggle theme">
          <!-- Sun icon (shown in dark mode) -->
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
          <!-- Moon icon (shown in light mode) -->
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- No Platform State -->
    <div class="no-platform" id="noPlatform">
      <div class="no-platform-icon">
        <img src="../assets/icons/brain-cog-48.png" alt="">
      </div>
      <h2>No supported platform</h2>
      <p>Visit Reddit, Twitter, Facebook, Instagram, LinkedIn, YouTube, or Amazon to see manipulation stats.</p>
      <div class="request-section" id="requestSection" style="display: none;">
        <p class="current-site">Current site: <strong id="currentSiteName">-</strong></p>
        <button class="request-btn" id="requestBtn">Request AttentionGuard for this site</button>
      </div>
    </div>

    <!-- Active Platform State -->
    <div class="active-platform" id="activePlatform" style="display: none;">
      <!-- Platform Header -->
      <div class="platform-header" id="platformHeader">
        <div class="platform-info">
          <span class="platform-icon" id="platformIcon"></span>
          <span class="platform-name" id="platformName">Platform</span>
        </div>
        <span class="session-time" id="sessionTime">0:00</span>
      </div>

      <!-- Main Score -->
      <div class="main-score" id="mainScore">
        <div class="score-circle">
          <svg viewBox="0 0 100 100">
            <circle class="score-bg" cx="50" cy="50" r="45"></circle>
            <circle class="score-progress" id="scoreProgress" cx="50" cy="50" r="45"></circle>
          </svg>
          <div class="score-value">
            <span class="score-number" id="scoreNumber">0</span>
            <span class="score-percent">%</span>
          </div>
        </div>
        <div class="score-label">INFLUENCED</div>
      </div>

      <!-- Stats Cards (clickable) -->
      <div class="stats-grid">
        <div class="stat-card ads" data-category="ads">
          <span class="stat-icon">ðŸŽ¯</span>
          <span class="stat-value" id="adsCount">0</span>
          <span class="stat-label">Ads</span>
        </div>
        <div class="stat-card algo" data-category="algorithmic">
          <span class="stat-icon">ðŸ¤–</span>
          <span class="stat-value" id="algoCount">0</span>
          <span class="stat-label">Algorithmic</span>
        </div>
        <div class="stat-card social" data-category="social">
          <span class="stat-icon">ðŸ‘¥</span>
          <span class="stat-value" id="socialCount">0</span>
          <span class="stat-label">Social</span>
        </div>
        <div class="stat-card organic" data-category="organic">
          <span class="stat-icon">âœ“</span>
          <span class="stat-value" id="organicCount">0</span>
          <span class="stat-label">Organic</span>
        </div>
      </div>

      <!-- Progress Bar -->
      <div class="progress-section">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-labels">
          <span>Influenced: <strong id="manipulatedCount">0</strong></span>
          <span>Total: <strong id="totalCount">0</strong></span>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button class="reset-btn" id="resetBtn">Reset Session</button>
        <label class="persist-toggle">
          <input type="checkbox" id="persistToggle">
          <span>Keep data across restarts</span>
        </label>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <span>Powered by <a href="https://agentkite.com" target="_blank">AgentKite</a></span>
      <a href="https://github.com/agentkite/attentionguard" target="_blank" class="github-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
        </svg>
      </a>
    </footer>
  </div>

  <!-- Category Details Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <div class="modal-header">
        <h3>
          <span class="modal-icon" id="modalIcon"></span>
          <span id="modalTitle">Category</span>
        </h3>
        <button class="modal-close" id="modalClose">&times;</button>
      </div>
      <div class="modal-body" id="modalBody">
        <!-- Content injected by JS -->
      </div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
